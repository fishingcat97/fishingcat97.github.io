---
redirect_from: /_posts/2022-03-15-3-存储器.md
title: 第三章 存储器
tags: 计算机组成原理
---

## 3.1 存储器概述

### 3.1.1、存储器分类

1.按存储介质分

- 半导体存储器：存储元件由半导体器件组成的叫半导体存储器。其优点是体积小、功耗低、存取时间短。其缺点是当电源消失时,所存信息也随即丢失,它是一种易失性存储器。
- 磁表面存储器：磁表面存储器是在金属或塑料基体的表面上涂一层磁性材料作为记录介质,工作时磁层随载磁体高速运转,用磁头在磁层上进行读写操作,故称为磁表面存储器。按载磁体形状的不同,可分为磁盘、磁带和磁鼓。这类存储器具有非易失性的特点
- 磁芯存储器：磁芯是由硬磁材料做成的环状元件,在磁心中穿有驱动线(通电流)和读出线,这样便可进行读写操作。磁心属磁性材料,故它也是不易失的永久记忆存储器。不过,磁心存储器的体积过大、工艺复杂、功耗太大
- 光盘存储器：光盘存储器是应用激光在记录介质(磁光材料)上进行读写的存储器,具有非易失性的特点。记录密度高、耐用性好、可靠性高和可互换性强。

2.按存取方式分

(1) 存取时间与物理地址无关（随机访问）  

所谓「随机访问」,指的是当存储器中的讯息被读取或写入时,所需要的时间与这段信息所在的位置无关，可根据地址直接访问数据。

- 随机存储器RAM:RAM是一种可读写存储器,根据地址访问数据，而不是根据顺序访问数据。
- 只读存储器:ROM:只读存储器是能对其存储的内容读出,而不能对其重新写入的存储器。 

(2) 存取时间与物理地址有关（串行访问）

所谓「串行访问」如果对存储单元进行读写操作时,需按其物理位置的先后顺序寻找地址,则这种存储器叫作串行访问存储器。这种存储器由于信息所在位置不同,存取顺序访问存储设备中的信息时,其所需要的时间与位置有关系。。

- 顺序存取存储器：不论信息处在哪个位置,读写时必须从其介质的始端开始按顺序寻找，如磁带。
- 直接存取存储器：读写时,首先直接指出该存储器中的某个小区域(磁道),然后再顺序寻访,直至找到位置。故其前段是直接访问,后段是串行访问，如磁盘

3.按在计算机中的作用分类

- 主存储器：主存储器的主要特点是它可以和CPU直接交换信息
- 辅助存储器：辅助存储器是主存储器的后援存储器,用来存放当前暂时不用的程序和数据,它不能与CPU直接交换信息。
- 缓冲存储器：缓冲存储器用在两个速度不同的部件之中,如CPU与主存之间可设置一个快速缓冲存储器,起到缓冲作用
- 主存速度快、容量小、每位价格高;辅存速度慢、容量大、每位价格低。

![存储器分类](/assets/image/计算机组成原理/存储器/存储器分类.jpg)

### 3.1.2 存储器的层次结构

存储器有三个主要特性:速度、容量和价格/位(简称位价)。一般来说,速度越高,位价就越高;容量越大,位价就越低;而且容量越大,速度必越低。

![存储器分层结构图](/assets/image/计算机组成原理/存储器/存储器分层结构图.jpg)

主存用来存放将要参与运行的程序和数据,其速度与CPU速度差距较大,为了使它们之间速度更好匹配,在主存与CPU之间,插入了一种比主存速度更快、容量更小的高速缓冲存储器 Cache,显然其位价要高于主存。主存与缓存之间的数据调动是由硬件自动完成的,对程序员是透明的。辅助存储器其容量比主存大得多,大都用来存放暂时未用到的程序和数据文件。CPU不能直接访问辅存,辅存只能与主存交换信息,因此辅存的速度可以比主存慢得多。辅存与主存之间信息的调动,均由硬件和操作系统来实现。

![CPU-缓存-主存-缓存层次图](/assets/image/计算机组成原理/存储器/CPU-缓存-主存-缓存层次图.jpg)

## 3.2 主存储器

### 3.2.1 主存储器概述

根据MAR中的地址访问某个存储单元时,还需经过地址译码、驱动等电路,才能找到所需访问的单元。读出时,需经过读出放大器,才能将被选中单元的存储字送到MDR。写入时,MDR中的数据也必须经过写入电路才能真正写入到被选中的单元中。

![主存的基本组成](/assets/image/计算机组成原理/存储器/主存的基本组成.jpg)

现代计算机的主存都由半导体集成电路构成,图中的驱动器、译码器和读写电路均制作在存储芯片中,而MAR和MDR制作在CPU芯片内。存储芯片和CPU芯片可通过总线连接。

当要从存储器读出某一信息字时,首先由CPU将该字的地址送到MAR,经地址总线送至主存,然后发读命令。主存接到读命令后,得知需将该地址单元的内容读出,便完成读操作,将该单元的内容读至数据总线上,至于该信息由MDR送至什么地方,这已不是主存的任务,而是由CPU决定的。若要向主存存入一个信息字时,首先CPU将该字所在主存单元的地址经MAR送到地址总线,并将信息字送入MDR,然后向主存发写命令,主存接到写命令后,便将数据线上的信息写入到对应地址线指出的主存单元中。

![主存和CPU的关系](/assets/image/计算机组成原理/存储器/主存和CPU的关系.jpg)

- 大端存储与小端存储
    - 大端（存储）模式：是指一个数据的低位字节的内容放在高地址处，高位字节存的内容放在低地址处。
    - 小端（存储）模式：是指一个数据的低位字节内容存放在低地址处，高位字节的内容存放在高地址处。

- 主存中存储单元地址的分配

**什么是寻址？**  

寻址指当CPU请求数据时获得该数据在内存上的位置的过程。内存上存储的所有数据都会有一个可以区分的地址，这与其存放的位置相对应，当CPU请求数据时，内存中的电路会根据CPU的地址线上的信号利用数据总线向CPU返回数据。

地址线是用于传输地址信息的数据线，一根地址线可以通过高电平或低电平来区分1或0，因此一根地址线有两个状态：1或0，那么N根地址线可以表示2^n个不同的状态。
 
主存各存储单元的空间位置是由单元地址号来表示的,而地址总线是用来指出存储单元地址号的,根据该地址可读出一个存储字。不同的机器存储字长也不同,为了满足字符处理的需要,常用8位二进制数表示一个字节,因此存储字长都取8的倍数。通常计算机系统既可按字寻址,也可按字节寻址，字地址是用该字在内存中首个字节的地址来表示。32位字长，8条地址线主存地址如下：  

![主存寻址图](/assets/image/计算机组成原理/存储器/主存寻址图.jpg)
   
1.按字节寻址  

按字节寻址指一个地址线表示的数（即状态）与一个字节地址相对应。比如一台机器有30根地址线，如果按字节寻址，其寻址范围是2^{30}=1GB。注意这里用的单位是B，原因如上文所述，30根地址线对应的是磁盘中的存储空间的基本单位，即1B，8个位。

主存就像一个小区，每个字就像小区里的一栋楼，而每个字节就像每栋楼里的一套房子。按字节寻址就像是对小区里每栋楼里所有的房子放在一起进行编号。而地址线有0/1状态，按照地址线的条数地址线可以编号的范围为(2^地址线数)。

一台 IBM370 字长为32位，主存的地址线为24位，如果按照字节寻址，那么按照字节寻址的范围为2^24=16MB。

一台 PDP-11 字长为16位，主存的地址线为24位，如果按照字节寻址，那么按照字节寻址的范围为2^24=16MB。

2.按字寻址  

计算机以此方式寻址时，每一个地址值指向了一个字，这里指向的便不是按字节寻址中的字节了。如前文所述对字的定义，一个字里面有任意个字节，那么计算机如何知道其地址指向的到底是字中的第几个字节呢？这便需要地址线中分出一部分标出其所指的到底是字中的第一个字节，还是第二个，亦或是其他。比如一个计算机有30根地址线，如果按字寻址，其字的字长为32位的话，那么每个字长有4个字节，4个字节用二进制编码需要两位来区分（比如第1、2、3、4个字节分别为00，01，10，11）因此真正用来表示字的位置的地址线有30-2=28根，其寻址范围是2^28=256MW。注意这里单位为W表示一个字。

主存就像一个小区，每个字就像小区里的一栋楼，而每个字节就像每栋楼里的一套房子。按字寻址就像将小区里的每栋楼进行二进制编号，但是每栋楼里还有若干套房子，如果相定位到相应的房子还需要对每栋楼里的房子进行编号，假设每栋楼里有N套房子，则需要⌈logN⌉位二进制编码。地址总线有X条，本来可以表示2^X栋楼，但是还需要⌈logN⌉条表示房子，则只剩X-⌈logN⌉条地址线表示楼，可以表示楼的范围则为2^(X-⌈logN⌉).

一台 IBM370 字长为32位，主存的地址线为24位，如果按照字寻址，那么按照字寻址的范围为2^(24-log4)=2^22=4MW。

一台 PDP-11 字长为16位，主存的地址线为24位，如果按照字寻址，那么按照字寻址的范围为2^(24-log2)=2^23=8MW。

- 主存的技术指标

(1)存储容量

存储容量是指主存能存放二进制代码的总数：存储容量=存储单元个数×存储字长  
存储容量也可用字节总数来表示：存储容量=存储单元个数×存储字长/8  

(2)存储速度

存储速度是由存取时间和存取周期来表示的。  

存取时间又叫存储器的访问时间( Memory Access Time),它是指启动次存储器操作(读或写)到完成该操作所需的全部时间。存取时间分读出时间和写入时间两种。读出时间是从存储器接收到有效地址开始,到产生有效输出所需的全部时间。写入时间是从存储器接收到有效地址开始,到数据写入被选中单元为止所需的全部时间  

存取周期( Memory Cycle Time)是指存储器进行连续两次独立的存储器操作(如连续两次读操作)所需的最小间隔时间,通常存取周期大于存取时间。

### 3.2.2 半导体存储芯片简介

1.半导体存储芯片的基本结构  

![半导体存储芯片基本结构](/assets/image/计算机组成原理/存储器/半导体存储芯片基本结构.jpg)

片选线用来选择存储芯片。由于存储器是由许多芯片组成,需用片选信号来确定哪个芯片被选中。例如,一个64K×8位的存储器可用32片16K×1位存储芯片组成,如图所示。但每次读出一个存储字时,只需选中8片。

![存储芯片片选线](/assets/image/计算机组成原理/存储器/存储芯片片选线.jpg)

2.半导体存储芯片的译码驱动方式  

(1)线选法



(2)重合法

## 3.3 高速缓冲存储器



## 3.4 辅助存储器